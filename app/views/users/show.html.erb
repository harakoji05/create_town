<div class="user_flex">
	<div class="user_show">
		<div class="user_show_title">
			<h1>マイページ</h1>
		</div>

		<div class="">
			<%= attachment_image_tag @user, :profile_image,format: 'jpeg', fallback: "no_image.jpg" ,  size: "150x150", class:"user_show_image"%>
			<% if current_user.id == @user.id %>
			<%= link_to "編集", edit_user_path(@user) %>
			<% end %>
		</div>

		<div class="user_show_edit">
		</div>

		<div class="user_show_item">
			<span><%= @user.last_name + @user.first_name %></span>
			<span>やりたいこと:　<%= @user.interest %></span>
			<span>会いたい人:　<%= @user.person %></span>
			<span><%= @user.user_status %></span>
			<span class="user_show_introduction"><%= simple_format(@user.introduction) %></span>
			<span>所属:<%= @user.affiliation %></span>
			<span>職業:<%= @user.job %></span>
			<span>活動拠点<br/><%= @user.address %></span>
		</div>

		<div class="user_show_item">
	    	<div id="profile_map"></div>
		</div>
	</div>

	<div class="post_index">
		<% @posts.each do |post| %>
			<div class="post_item">
				<table>
					<tbody align="center">
						<tr>
							<td align="center"><%= link_to post_path(post) do %>
								<%= attachment_image_tag post, :image,format: 'jpeg', fallback: "no_image.jpg" ,  size: "250x150"%>
								<% end %>
							</td>
						</tr>
						<tr>
							<td><span><%= post.title %></span></td>
						</tr>

						<tr>
							<td><span><%= post.category %></span></td>
						</tr>
						<% if post.address.present? %>
						<tr align="right" >
							<td>
								<div class="prefecture_name">
									<span><%= post.address.match(/東京都|北海道|(?:京都|大阪)府|.{2,3}県/).to_s %></span>
								</div>
							</td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		<% end %>

		<div  class="post-pagenate">
			<%= paginate @posts %>
		</div>
	</div>
</div>



<script type="text/javascript">
  function initMap() {
    var test ={lat: <%= @user.latitude %>, lng: <%= @user.longitude %>};
    var map = new google.maps.Map(document.getElementById('profile_map'), {
              zoom: 15,
              center: test
              });
    var transitLayer = new google.maps.TransitLayer();
    transitLayer.setMap(map);

    var contentString = 'やりたいこと：<%= @user.interest %>';
    var infowindow = new google.maps.InfoWindow({
      content: contentString
    });

    var marker = new google.maps.Marker({
                  position:test,
                  map: map,
                  title: contentString
                 });

     marker.addListener('click', function() {
       infowindow.open(map, marker);
     });
  }
</script>

<script async defer src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap"></script>




</div>